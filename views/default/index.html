{{extend 'layout.html'}}

{{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- FIXME: this should not be needed, but it is VVV -->
<script src="{{=URL('static', 'js/gchart.js')}}"></script>

<script>
  var check_login_url = "{{=URL('api', 'check_login')}}";
  var upload_url = "{{=URL('default', 'upload_form')}}";
  var get_fields_url = "{{=URL('api', 'get_fields')}}";
  var start_clustering_url = "{{=URL('api', 'start_clustering')}}";
</script>

<script src="{{=URL('static', 'js/dropzone.js')}}"></script>

<script>
$(function() {
  Dropzone.options.fileUploader = {
    maxFilesize: 10, // MB
    url: upload_url,
    addRemoveLinks: true,
    parallelUploads: 1,
    acceptedFiles: '.csv', 
    createImageThumbnails: false,
    init: function() {
      this.on("queuecomplete", function() {
      });
    }
  }
});

</script>

{{end}}

<div class="main_content">

        <div id="chart_div" style="width: 900px; height: 500px;"></div>

  <div id="vue-div">
  <!-- test1@gmail.com ,test -->
<!--     <div v-if="!logged_in"><h3>Hi, Welcome to ClusterSolver. Please log in at the top right to start!</h3></div>
    <div v-if="logged_in">
 -->      
      <!-- FIXME: problem with logging in and using dropzone -->
      <div id="upload_div" v-if="page == 'upload'"> 
        <h3>Welcome to ClusterSolver!. Please input a .csv file to perform clustering on! Please use commas to separate the values and not spaces!</h3><br>

        <div id="uploader_div">
          <form action="" class="dropzone dz-clickable" id="file-uploader">
            <div class="dz-message">
              Drop files here to upload them, or click to select them.
            </div>
          </form>
          <div v-if="logged_in">
            <button class="btn btn-warning btn-sm" v-on:click="upload_button_clicked()">Upload</button>
          </div>
          <div v-if="!logged_in">
            <button class="btn btn-warning btn-sm disabled">Upload</button><br>
            Please log in to start!          
          </div>
        </div>      




      </div>
      <div id="settings_div" v-if="page == 'settings'"> 
      Please chose <b>one</b> field that you want to focus on.
        <div class="fields" v-for="f in fields">
          <input type='checkbox' v-on:click="push_field(f)">
          ${f}
        </div>
          
          <br>
          Please input the number of clusters you would like:
          <br>
          <textarea class="small_area" v-model="input_k" placeholder="# of Clusters" type="text"></textarea>
          <br>
          Please input an lower bound for X:
          <br>
          <textarea class="small_area" v-model="x_lower" placeholder="X Lower Bound" type="text"></textarea>
          <br>
          Please input an upper bound for X:
          <br>
          <textarea class="small_area" v-model="x_upper" placeholder="X Upper Bound" type="text"></textarea>
          <br>
          Please input an lower bound for Y:
          <br>
          <textarea class="small_area" v-model="y_lower" placeholder="Y Lower Bound" type="text"></textarea>
          <br>
          Please input an upper bound for Y:
          <br>
          <textarea class="small_area" v-model="y_upper" placeholder="Y Upper Bound" type="text"></textarea>
          <br>
          Please select the # of iterations you want to run:
          <br>
          <textarea class="small_area" v-model="num_iters" placeholder="# of Iterations" type="text"></textarea>
          <br>


        <button class="btn btn-warning btn-sm" v-on:click="continue_button_clicked()">Continue to Clustering</button>
        <div class="error_message" v-if="is_error">
          ${ err_message }
        </div>
      </div>

      <div id="clustering_div" v-if="page == 'clustering'">



        <div id="new_data">
          Feel free to add more points to predict on: <br>
          <div v-for="i in f_index">
            ${fields[i]}: <br>
            <textarea class="input_area" v-model="new_data[i]" type="text"></textarea>
              
          </div>
          <button class="btn btn-warning btn-sm">Add</button>

        </div>

        <!--FIXME: include "add to collection" btn -->

      </div>

    <!-- VVV comment out this div -->
<!--     </div>
 -->  </div>
</div>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>

