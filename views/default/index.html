{{extend 'layout.html'}}

{{block head}}
<!-- MDL PACKAGES -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.indigo-pink.min.css">
<script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>

<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- FIXME: this should not be needed, but it is VVV -->
<script src="{{=URL('static', 'js/gchart.js')}}"></script>

<script>
  var check_login_url = "{{=URL('api', 'check_login')}}";
  var upload_url = "{{=URL('default', 'upload_form')}}";
  var get_fields_url = "{{=URL('api', 'get_fields')}}";
  var preprocess_data_url = "{{=URL('api', 'preprocess_data')}}";
  var start_clustering_url = "{{=URL('api', 'start_clustering')}}";
  var add_to_profile_url = "{{=URL('api', 'add_to_profile')}}";
  var get_graphs_url = "{{=URL('api', 'get_graphs')}}";
</script>

<script src="{{=URL('static', 'js/dropzone.js')}}"></script>

<script>
$(function() {
  Dropzone.options.fileUploader = {
    maxFilesize: 10, // MB
    url: upload_url,
    addRemoveLinks: true,
    parallelUploads: 1,
    acceptedFiles: '.csv', 
    createImageThumbnails: false,
    init: function() {
      this.on("queuecomplete", function() {
      });
    }
  }
});

</script>

{{end}}
<body>

<div class="main_content">

  <div id="chart_div_1" style="width: 900px; height: 500px;"></div>
  <div id="chart_div_2" style="width: 900px; height: 500px;"></div>
  <div id="chart_div_3" style="width: 900px; height: 500px;"></div>
  <div id="chart_div_4" style="width: 900px; height: 500px;"></div>
  <div id="chart_div_5" style="width: 900px; height: 500px;"></div>

<div id="vue-div">

  <div class="home" v-if="page == 'home'">

    <div class="section splash-box">
      <div class="section-inner">
        <center><img id="clustersolver-logo" src="/ClusterSolver/static/images/clustersolver_logo_small.png"></center>
        <div class="spash-text alone">
          <center><h1>Easy Clustering for any data</h1></center>
        <div id="index_btns">
          <!-- FIXME: change buttons to MDL designs -->
          <center><button v-if="!home_upload_btn" class="btn btn-warning" v-on:click="home_upload_btn_clicked()">Upload</button></center><br>
          <center><button v-if="home_upload_btn" class="btn btn-warning" v-on:click="home_upload_btn_clicked()">Quit Upload</button></center><br>

          
          <div id="uploader_div" v-bind:class="{ 'hidden' : !home_upload_btn }">
            <form action="" class="dropzone dz-clickable" id="file-uploader">
            <div class="dz-message">
              Drop a .csv file here for upload, or click here to select them.
            </div>
            </form>
            <div v-if="logged_in">
              <button class="btn btn-warning btn-sm" v-on:click="upload_button_clicked()">Import</button>
            </div>
          </div>
          <center><button class="btn btn-success btn" v-on:click="show_news_feed()">View News Feed</button></center>
        </div>
        </div>
      </div>
    </div>

    <div class="section steps">
      <h3>Clustering in 4 easy steps</h3>
      <ul class="steps-list-icon mdl-list">
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">
          <i class="material-icons">import_export</i>
          <div class="step_text">
          Upload .csv file
          </div>
      </span>
        </li>
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">
          <i class="material-icons">settings</i>
          <div class="step_text">
          Choose parameters and settings for clusterings
          </div>
        </span>
        </li>
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">
          <i class="material-icons">equalizer</i>
          <div class="step_text">
          View clusters and insert new data
          </div>
        </span>
        </li>  
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">
          <i class="material-icons">library_add</i>
          <div class="step_text">
            Add to your personal collection
          </div>
        </span>
        </li>
      </ul>

    </div>

    <!-- FIXME: IMPLEMENT SLIDERS FOR SETTINGS -->
<!--     <input id="slider3" class="mdl-slider mdl-js-slider" type="range"  
         min="0" max="100" tabindex="0" step="2" 
         v-model="slider_val">
   <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
    <div>${ slider_val }</div> -->
  
  </div>





  <!-- test1@gmail.com ,test -->
<!--     <div v-if="!logged_in"><h3>Hi, Welcome to ClusterSolver. Please log in at the top right to start!</h3></div>
    <div v-if="logged_in">
 -->      
      <!-- FIXME: problem with dropzone when it's the 2nd page -->
<!--       <div id="upload_div" v-if="page == 'upload'"> 
          <div v-if="!logged_in">
            <button class="btn btn-warning btn-sm disabled">Upload</button><br>
            Please log in to start!          
          </div>
        </div>      
      </div> -->

  <div id="settings_div" v-if="page == 'settings'"> 
  Please chose <b>one</b> field that you want to focus on.
    <div class="fields" v-for="f in fields">
      <input type='checkbox' v-on:click="push_field(f)">
      ${f}
    </div>
    <button class="btn btn-success btn-sm" v-if="!more_settings_btn" v-on:click="more_settings_btn_clicked()">More Settings</button>

    <!-- FIXME: put in two columns,  explain each setting on page-->
    <!-- Let the user choose between advanced and default settings -->
    <div class="more_settings" v-if="more_settings_btn">
      <div class="row">
        <br>
        # of Clusters: ${ input_k }
        <br>
        <div class="col-md-6">
          <p style="width: 300px;">
            <input id="slider3" class="mdl-slider mdl-js-slider col-md-6" type="range"  
             min="0" max="50" tabindex="0" step="1" 
             v-model="input_k">
          </p>
        </div>
        <div class="col-md-6">HELLO</div>
<!--       <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
 -->      
      </div>
  
      <div class="row">    
        <br>
        Upper bound for X: ${ x_upper }
        <br>
        <div class="col-md-6">
          <p style="width: 300px;">
            <input id="slider3" class="mdl-slider mdl-js-slider"  type="range"  
             min="0" max="100" tabindex="0" step="1" 
             v-model="x_upper">
          </p>
        </div>
        <div class="col-md-6">HELLO</div>
      </div>
  <!--       <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
   -->
    <div class="row">
      <br>
      Upper bound for Y: ${ y_upper }
      <br>
      <div class="col-md-6">
        <p style="width: 300px;">
          <input id="slider3" class="mdl-slider mdl-js-slider col-md-6" type="range"  
           min="0" max="100" tabindex="0" step="1" 
           v-model="y_upper">
        </p>
      </div>
      <div class="col-md-6">HELLO</div>
    </div>

  <!--       <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
   -->      
    <div class="row">
      <br>
      # of iterations: ${ num_iters }
      <br>
      <div class="col-md-6">
        <p style="width: 300px;">
          <input id="slider3" class="mdl-slider mdl-js-slider col-md-6" type="range"  
           min="0" max="500" tabindex="0" step="1" 
           v-model="num_iters">
        </p>
      </div>
      <div class="col-md-6">HELLO</div>
    </div>

  <!--       <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
  -->

    <div class="row">
      <br>
      New Cluster Parameter: ${ new_clust_param }
      <br>
      <div class="col-md-6">
      <p style="width: 300px;">

        <input id="slider3" class="mdl-slider mdl-js-slider col-md-6" type="range"  
           min="0" max="500" tabindex="0" step="1" 
           v-model="new_clust_param">
      </p>
      </div>
      <div class="col-md-6">HELLO</div>
    </div>
  <!--       <div class="mdl-tooltip" data-mdl-for="slider3">${slider_val}</div>
  -->

<!--       <textarea class="small_area" v-model="input_k" placeholder="# of Clusters" type="text"></textarea>
      <br>
      Please input an lower bound for X:
      <br>
      <textarea class="small_area" v-model="x_lower" placeholder="X Lower Bound" type="text"></textarea>
      <br>
      Please input an upper bound for X:
      <br>
      <textarea class="small_area" v-model="x_upper" placeholder="X Upper Bound" type="text"></textarea>
      <br>
      Please input an lower bound for Y:
      <br>
      <textarea class="small_area" v-model="y_lower" placeholder="Y Lower Bound" type="text"></textarea>
      <br>
      Please input an upper bound for Y:
      <br>
      <textarea class="small_area" v-model="y_upper" placeholder="Y Upper Bound" type="text"></textarea>
      <br>
      Please select the # of iterations you want to run:
      <br>
      <textarea class="small_area" v-model="num_iters" placeholder="# of Iterations" type="text"></textarea>
      <br> -->


      <!-- FIXME: Add a parameter to let the user chose how much they want to depend on the field they have chosen -->


      <button class="btn btn-warning btn-sm" v-on:click="continue_button_clicked()">Continue to Clustering</button>
      <div class="error_message" v-if="is_error">
        ${ err_message }
      </div>
    </div>


  </div>

      <div id="clustering_div" v-if="page=='clustering'">
        <div id="new_data">
          Feel free to add more points to predict on: <br>
          <div v-for="i in f_index">
            ${fields[i]}: <br>
            <textarea class="input_area" v-model="new_data[fields[i]]" type="text"></textarea> 
          </div>
          <button class="btn btn-warning btn-sm" v-on:click="insert_point()">Insert and Classify Point</button><br>
          <button class="btn btn-success btn-sm" v-on:click="add_to_profile()">Add to Profile</button><br>
        </div>
      </div>

      <div id="profile_div" v-if="page=='profile'">
        Here is a list of your most recent plots:<br>
        Select <b>one</b> plot you would like to view again:<br>
        <button class="btn btn-warning btn-sm" v-on:click="view_plot()">View Plot</button><br>
        <button class="btn btn-success btn-sm" v-on:click="change_page('upload')">Back to Upload</button><br>

      </div>

    <!-- VVV comment out this div -->
<!--     </div>
 -->  </div>
</div>
</body>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>

<!-- FIXME:
      1. change background color of div on homepage
      2. back btns for each page -->